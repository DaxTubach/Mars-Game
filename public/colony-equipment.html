<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Colony Equipment</title>
  <link href="css/colony-equipment.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-firestore.js"></script>
  <script type="text/javascript" src="auth.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

  <script>
    window.onload = function () {
      initApp();

      document.getElementById('continue').addEventListener('click', setEquipment, false);
      document.getElementById('sign-out').addEventListener('click', signOut, false);
    }
    var equipment = {};
    
    function setEquipment() {
      var user = firebase.auth().currentUser
      var uid = user.uid;
      db.collection('users').doc(uid)
        .update({
          equipment: true,
        })
        .then(() => {
          console.log('Document successfully written! With ID ', uid);
          post();
        })
        .catch((error) => {
          console.error('Error writing document: ', error);
        });
    }

  </script>

</head>

<body>


  <div class="header">
    <button class="sign-out-button" id="sign-out">Sign Out</button>

    <div>
      <a href="colony-selection.html" class="back-button">&leftarrow;</a>
      <h1>Select Your Equipment</h1>
    </div>
    <div class="equipment-funds-remaining-container">
      <div>
        <span>Discretionary Funds Remaining (in millions): $
          <span id="equipment-funds-remaining">1000</span>
        </span>
      </div>
    </div>
  </div>

  <div class="header2">
    <button class="continue-button" id="continue" type="submit">Continue &rightarrow;</button>
  </div>

  <div class="main">
    <div class="equipment-type-container">
      <h2 class="equipment-type-title">Spacecraft Components</h2>
      <form class="equipment-checklist" action="" method="">
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" value="50">
            <label>Aluminum Radiation Shielding</label>
          </span>
          <span class="equipment-price">$ 50</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" value="30">
            <label>Landing Inflatables</label>
          </span>
          <span class="equipment-price">$ 30</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" value="100">
            <label>Retrograde Rockets</label>
          </span>
          <span class="equipment-price">$ 100</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" value="100">
            <label>Magnetic Shielding</label>
          </span>
          <span class="equipment-price">$ 100</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" value="25">
            <label>On board hydroponics</label>
          </span>
          <span class="equipment-price">$ 25</span>
        </div>
      </form>
    </div>
    <div class="equipment-type-container">
      <h2 class="equipment-type-title">Equipment</h2>
      <form class="equipment-checklist" action="" method="">
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="radar_dish" value="15">
            <label>Radar Dish</label>
          </span>
          <span class="equipment-price">$ 15</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="hydroponics_equipment" value="20">
            <label>Hydroponics System</label>
          </span>
          <span class="equipment-price">$ 20</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="first_aid_supplies" value="10">
            <label>First Aid Supplies</label>
          </span>
          <span class="equipment-price">$ 10</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="moxie_equipment" value="50">
            <label>Surgical Equipment</label>
          </span>
          <span class="equipment-price">$ 50</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="grown_plants" value="25">
            <label>Grown Plants</label>
          </span>
          <span class="equipment-price">$ 25</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="moxie_equipment" value="50">
            <label>MOXIE Oxygen Generator</label>
          </span>
          <span class="equipment-price">$ 50</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="auger" value="50">
            <label>Auger</label>
          </span>
          <span class="equipment-price">$ 50</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="water_storage" value="1">
            <label>Water Storage</label>
          </span>
          <span class="equipment-price">$ 1</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="battery" value="15">
            <label>Battery</label>
          </span>
          <span class="equipment-price">$ 15</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="pressurized_airlock_equipment" value="5">
            <label>Pressurized Airlock Equipment</label>
          </span>
          <span class="equipment-price">$ 5</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="uv_lights" value="5">
            <label>UV Lights</label>
          </span>
          <span class="equipment-price">$ 5</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="nuclear_reactor" value="500">
            <label>Nuclear Reactor</label>
          </span>
          <span class="equipment-price">$ 500</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="entertainment_system" value="5">
            <label>Entertainment System</label>
          </span>
          <span class="equipment-price">$ 5</span>
        </div>
        <div class="equipment-checkbox-container">
          <span>
            <input type="checkbox" class="checkbox" id="research_equipment" value="50">
            <label>Research Equipment</label>
          </span>
          <span class="equipment-price">$ 50</span>
        </div>
      </form>
    </div>
  </div>

  <div class="stars"></div>
  <div class="twinkling"></div>

  <script>
    // Convert 'funds remaining' to integer
    let fundsRemainingStr;
    fundsRemainingStr = document.getElementById('equipment-funds-remaining').innerHTML;
    let fundsRemaining = convertStrToInt(fundsRemainingStr);

    // Actions for when a checkbox is checked and unchecked
    $('.checkbox').click(function () {
      let equipmentCostStr;
      equipmentCostStr = $(this).attr('value');
      let equipmentCost = convertStrToInt(equipmentCostStr);

      if (itemIsChecked(this)) {
        newfundsRemaining = fundsRemaining - equipmentCost;
        if (newfundsRemaining < 0) {
          alert('You do not have enough funds for this item.');
          $(this).prop('checked', false);
        }
        else {
          fundsRemaining = newfundsRemaining;
          $('#equipment-funds-remaining').empty();
          $('#equipment-funds-remaining').append('<span id="equipment-funds-remaining-value">' + fundsRemaining + '</span>');
        }
      }
      else {
        fundsRemaining = fundsRemaining + equipmentCost;
        $('#equipment-funds-remaining').empty();
        $('#equipment-funds-remaining').append('<span id="equipment-funds-remaining-value">' + fundsRemaining + '</span>');
      }
    });

    function itemIsChecked(x) {
      if ($(x).is(':checked')) return true;
      else return false;
    }

    function convertStrToInt(inputStr) {
      return parseInt(inputStr, 10);
    }

  </script>

</body>

</html>