<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Colony Selection</title>
  <link href="css/colony-selection.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Varela+Round" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.8.2/firebase-firestore.js"></script>
  <script type="text/javascript" src="auth.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>
    // Styles 'Colony Type' div when selected
    window.onload = function() {
      initApp();

      document.getElementById('continue').addEventListener('click', createColony, true);
      document.getElementById('sign-out').addEventListener('click', signOut, true);

       // Selection for Colony types
       $(".colony-type-container").click(function () {
        removeSelectedStyle();
        let x = jQuery(this).attr("id");
       addSelectedStyle(x);
      });

      // Helper: removes "selected" style from all 'Colony Type' divs when a new Colony is selected
      function removeSelectedStyle() {
        $('.colony-type-container').removeClass("colony-type--selected");
      }

      // Helper: adds "selected" style to selected Colony div
      function addSelectedStyle(id) {
        let validID = `#${id}`;
        $(validID).addClass('colony-type--selected');
      }

  }

  function updateColonyLocation(xLoc,yLoc)
  {
        var user = firebase.auth().currentUser;
        var uid = user.uid;
        db.collection('users').doc(uid)
          .update({
              "colony.x" : xLoc,
              "colony.y" : yLoc
          })
          .then(() => {
              console.log('Document successfully written! With ID ', uid);
          })
          .catch((error) => {
              console.error('Error writing document: ', error);
          });
  }

  function createColony(){
    const colonyName = document.getElementById('colony-name').value;
    const username = document.getElementById('player-name').value;

    console.log(colonyName);
    console.log(username);

        if(colonyName != '' && username != ''){
          var user = firebase.auth().currentUser
          var uid = user.uid;
          db.collection('users').doc(uid)
            .update({
                name: username,
                colony: {Name : colonyName, x : null, y : null},            
            })
            .then(() => {
                console.log('Document successfully written! With ID ', uid);
                post('/start', {name: 'Tests'});
            })
            .catch((error) => {
                console.error('Error writing document: ', error);
            });
          }
          else
            alert("Please fill out forms");
        }



        /*
    db.collection("users").get()
    .then(function(querySnapshot) {
      var colonies = [];
        querySnapshot.forEach(function(doc) {
          // doc.data() is never undefined for query doc snapshots
          if(doc.data().colony != null)
            colonies.push(doc.data().colony);
        });
        console.log(colonies);;
    })
    .catch(function(error) {
        console.log("Error getting documents: ", error);
    });
    

*/
  </script>


</head>

<body>
  
  <button class="sign-out-button" id ="sign-out" >Sign Out</button>

  <div class="header">
    <h1>Which colony will you lead?</h1>
    <div class="player-info">
      <div>
        <span>Your Name:</span>
        <input class="player-info__input" id="player-name" type="text" required/>
      </div>
      <div>
        <span>Colony Name:</span>
        <input class="player-info__input" id="colony-name" type="text" required/>
      </div>
    </div>
  </div>

  <div class="main">
    <div class="colony-type-container" id="mining-colony">
      <div class="colony-type-header">
        <h3>Mining</h3>
      </div>
      <div class="colony-type-graphic">
        <img class="colony-type-icon" src="images/mining-icon.png" />
      </div>
      <div class="colony-type-description">
        here is a short description paragraph; here is a short description paragraph; here is a short description paragraph;
      </div>
    </div>

    <div class="colony-type-container" id="research-colony">
      <div class="colony-type-header">
        <h3>Research</h3>
      </div>
      <div class="colony-type-graphic">
        <img class="colony-type-icon" src="images/research-icon.png" />
      </div>
      <div class="colony-type-description">
        here is a short description paragraph; here is a short description paragraph; here is a short description paragraph;
      </div>
    </div>

    <div class="colony-type-container" id="agricultural-colony">
      <div class="colony-type-header">
        <h3>Agricultural</h3>
      </div>
      <div class="colony-type-graphic">
        <img class="colony-type-icon" src="images/plant-icon.png" />
      </div>
      <div class="colony-type-description">
        here is a short description paragraph; here is a short description paragraph; here is a short description paragraph;
      </div>
    </div>

    <div class="colony-type-container" id="residential-colony">
      <div class="colony-type-header">
        <h3>Residential & Tourism</h3>
      </div>
      <div class="colony-type-graphic">
        <img class="colony-type-icon" src="images/building-icon.png" />
      </div>
      <div class="colony-type-description">
        here is a short description paragraph; here is a short description paragraph; here is a short description paragraph;
      </div>
    </div>

    <div class="colony-type-container" id="manufacturing-colony">
      <div class="colony-type-header">
        <h3>Manufacturing</h3>
      </div>
      <div class="colony-type-graphic">
        <img class="colony-type-icon" src="images/wrench-icon.png" />
      </div>
      <div class="colony-type-description">
        here is a short description paragraph; here is a short description paragraph; here is a short description paragraph;
      </div>
    </div>

    <div class="colony-type-container" id="custom-colony">
      <div class="colony-type-header">
        <h3>Custom</h3>
      </div>
      <div class="colony-type-graphic">
        <img class="colony-type-icon" src="images/question-icon.png" />
      </div>
      <div class="colony-type-description">
        here is a short description paragraph; here is a short description paragraph; here is a short description paragraph;
      </div>
    </div>
  </div>

  <div class="footer">
    <button class="continue-button" id = "continue" type="submit">Continue &rightarrow;</button>
  </div>



</body>

</html>